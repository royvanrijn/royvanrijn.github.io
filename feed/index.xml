<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>royvanrijn</title>
    <description>Java, algorithms, math, science and more!</description>
    <link>https://royvanrijn.com/</link>
    <atom:link href="https://royvanrijn.com/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Mon, 14 Mar 2022 12:20:16 +0100</pubDate>
    <lastBuildDate>Mon, 14 Mar 2022 12:20:16 +0100</lastBuildDate>
    <generator>Jekyll v4.0.0</generator>
    
      <item>
        <title>Roadtrip to Ludolph van Ceulen</title>
        <description>&lt;p&gt;Today is March 14th (3/14), otherwise known as Pi Day!&lt;/p&gt;

&lt;h2 id=&quot;calculating-pi&quot;&gt;Calculating Pi&lt;/h2&gt;

&lt;p&gt;To celebrate Pi Day people often try to come up with cool and interesting ways to calculate œÄ, or to celebrate the number in weird ways.&lt;/p&gt;

&lt;p&gt;Here is a great example by the excellent Matt Parker (from Stand-up Maths):&lt;/p&gt;

&lt;iframe type=&quot;text/html&quot; width=&quot;640&quot; height=&quot;390&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;&quot; mozallowfullscreen=&quot;&quot; allowfullscreen=&quot;&quot; src=&quot;https://www.youtube.com/embed/CKl1B8y4qXw?title=0&amp;amp;byline=0&amp;amp;portrait=0&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;He‚Äôs using the ‚ÄúIsaac Newton‚Äù-way to calculate œÄ by hand. This method was discovered by Isaac Newton and German mathematician Gottfried Wilhelm Leibniz in 1665. And it uses ‚Äòinfinite series‚Äô.&lt;/p&gt;

&lt;h2 id=&quot;before-newton&quot;&gt;Before Newton&lt;/h2&gt;

&lt;p&gt;The method Newton used (infinite series) was mathematically superiour to all previous methods of calculating œÄ.&lt;/p&gt;

&lt;p&gt;That does raise a question: How did they calculate œÄ &lt;em&gt;before&lt;/em&gt; 1665?&lt;/p&gt;

&lt;p&gt;First let‚Äôs take one step back, what exactly &lt;em&gt;IS&lt;/em&gt; œÄ? œÄ is a mathematical constant: the ratio between a circle‚Äôs circumference and diameter. This means that if you have a circle with a diameter of 1, the circumference is œÄ (~ 3.14159‚Ä¶).&lt;/p&gt;

&lt;p&gt;Let‚Äôs try to come up with a very rough estimate what this ratio needs to be. What if we put our unit-circle with length 1 inside a square:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/circle-square.png&quot; alt=&quot;Circle inside a square&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We can conclude that the circumference, and therefor œÄ, is at most &lt;code class=&quot;highlighter-rouge&quot;&gt;4 x 1 = 4&lt;/code&gt;, this gives us the first upper bound.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/circle-in-square.jpeg&quot; alt=&quot;Square inside a circle&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now lets look at the other case, where the square fits inside the circle. In this case we can see that we have an equilateral triangle, with two sides &lt;code class=&quot;highlighter-rouge&quot;&gt;a&lt;/code&gt; that make the square. The length of &lt;code class=&quot;highlighter-rouge&quot;&gt;a&lt;/code&gt; is easy to calculate using Pythagoras theorom, the long side has a diameter of 1, this means &lt;code class=&quot;highlighter-rouge&quot;&gt;a&lt;/code&gt; needs to be &lt;code class=&quot;highlighter-rouge&quot;&gt;a^2 + a^2 = 1&lt;/code&gt;. If we rearrange everything we‚Äôll come to the conclusion that &lt;code class=&quot;highlighter-rouge&quot;&gt;a = sqrt(0.5)&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;This means that the circumference of the smaller square is &lt;code class=&quot;highlighter-rouge&quot;&gt;4 x sqrt(0.5) = ~ 2.82..&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;We can conclude that œÄ lies somewhere between &lt;code class=&quot;highlighter-rouge&quot;&gt;4&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;2.82&lt;/code&gt; üéâ&lt;/p&gt;

&lt;h2 id=&quot;archimedes-method&quot;&gt;Archimedes method&lt;/h2&gt;

&lt;p&gt;But can we do even better? Sure! What if, instead of placing our circle between two squares, we use pentagons, hexagons, or shapes with even more sides?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/750px-Archimedes_pi.png&quot; alt=&quot;Archimedes method&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As you can see, the shape get more and more rounded. So the upper and lower bounds converge towards our beloved œÄ!&lt;/p&gt;

&lt;p&gt;This method is known as &lt;em&gt;Archimedes method&lt;/em&gt;. Archimedes calculated, using a shape with &lt;strong&gt;128&lt;/strong&gt; sides, that œÄ had to be between &lt;code class=&quot;highlighter-rouge&quot;&gt;3.141&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;3.142&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;ludolph-van-ceulen&quot;&gt;Ludolph van Ceulen&lt;/h2&gt;

&lt;p&gt;Now it‚Äôs time to introduce our hero of today: &lt;a href=&quot;https://en.wikipedia.org/wiki/Ludolph_van_Ceulen&quot;&gt;Ludolph van Ceulen&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/Ludolf_van_Ceulen.jpeg&quot; alt=&quot;Ludolph van Ceulen&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ludolph spend his entire life to improve the calculated value of œÄ. Instead of using a 128-sided shape like Archimedes, he calculated œÄ using shapes with up to millions of sides. Let that sink in, a shape with a million sides, &lt;strong&gt;by hand&lt;/strong&gt;. By the time of his death van Ceulen managed to calculate œÄ up to 35 digits, an incredible feat.&lt;/p&gt;

&lt;p&gt;Ludolph was so pleased with his life goal that he requested the upper and lower bounds to be carved into his tombstone. Sadly the original tombstone went missing almost instantly no long after his death. However a new tombstone was added to the famous St. Peter‚Äôs Church in Leiden (The Netherlands) in the year 2000.&lt;/p&gt;

&lt;h2 id=&quot;visiting-leiden&quot;&gt;Visiting Leiden&lt;/h2&gt;

&lt;p&gt;About a month ago, my girlfriend and I, bored in lockdown, decided to do a roadtrip and visit the church in Leiden to see the tombstone for ourselves.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/tombstone-leiden.jpeg&quot; alt=&quot;St. Peter‚Äôs Church tombstone&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And there it is, here is a better picture of the plaque:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/tombstone-details.jpeg&quot; alt=&quot;St. Peter‚Äôs Church tombstone&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I‚Äôve tried to translate the plaque from ‚Äòold Dutch‚Äô into English and it reads something like:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Buried here is Mr. Ludolph van Ceulen.
He was a Dutch professor of Mathematics at the university of this city (Leiden).
Born in Hildesheim in the year 1540 at 28th of January.
Passed away 31st of December 1610.
During his life, through hard labour, he found the circle's circumference compared to the diameter to be...

If the diameter is 1
The circumference is at least:

3141592653589793238462643383279502881
-------------------------------------
100000000000000000000000000000000000

And at most:

3141592653589793238462643383279502891
-------------------------------------
100000000000000000000000000000000000

And if the diameter is 100000000000000000000000000000000000

The circumference is at least 
314159265358979323846264338327950288

And at most:
314159265358979323846264338327950289
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;He spend his &lt;strong&gt;entire life&lt;/strong&gt; to improve the upper and lower bounds, using more and more sided shapes, up to millions of sides. He was also the &lt;strong&gt;last&lt;/strong&gt; person to improve the records using this labour intensive method. The method co-discovered by Isaac Newton (using infinite series) proved to be much easier and faster to calculate. After that calculating œÄ by using complex shapes was a thing of the past.&lt;/p&gt;

&lt;p&gt;If you‚Äôre ever in Leiden, be sure to visit the church and pay respects to the incredible diligence of Ludolph van Ceulen.&lt;/p&gt;

&lt;p&gt;Happy Pi Day!&lt;/p&gt;

</description>
        <pubDate>Mon, 14 Mar 2022 03:14:15 +0100</pubDate>
        <link>https://royvanrijn.com/blog/2022/03/pi-day-2022/</link>
        <guid isPermaLink="true">https://royvanrijn.com/blog/2022/03/pi-day-2022/</guid>
        
        <category>pi</category>
        
        <category>piday</category>
        
        <category>algorithm</category>
        
        
        <category>Programming</category>
        
      </item>
    
      <item>
        <title>From Wordle to Nerdle</title>
        <description>&lt;p&gt;About two months ago I wrote a &lt;a href=&quot;/blog/2022/01/wordle-bot/&quot;&gt;blogpost&lt;/a&gt; about what strategies you could use to solve Wordle in the most efficient way. In the end I wrote a program that looks ahead a single guess and finds the word that gives you the most information.&lt;/p&gt;

&lt;p&gt;The main hype around Wordle (and all of the clones), seems to have settled down now‚Ä¶ but I still play &lt;em&gt;some&lt;/em&gt; of them.&lt;/p&gt;

&lt;h2 id=&quot;nerdle&quot;&gt;Nerdle&lt;/h2&gt;

&lt;p&gt;One clone I really enjoyed playing the last couple of weeks has been &lt;a href=&quot;https://nerdlegame.com/&quot;&gt;Nerdle&lt;/a&gt;. In the game Nerdle all your guesses need to be a valid mathematical calculation. For example: &lt;code class=&quot;highlighter-rouge&quot;&gt;31 + 56 = 87&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/nerdle_gameplay.png&quot; alt=&quot;Nerdle gameplay screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In this game, you can‚Äôt just write down anything, each and every try needs to be a valid calculation.&lt;/p&gt;

&lt;h3 id=&quot;generating-the-guesses&quot;&gt;Generating the guesses&lt;/h3&gt;

&lt;p&gt;Yesterday, when I had a bit of time with a colleague, we set about trying to adapt the Wordle-bot into a Nerdle-bot. In theory this would be extremely easy, the only hard part is getting a valid ‚Äúwordlist‚Äù.&lt;/p&gt;

&lt;p&gt;When I created the Wordle bot, I just downloaded a list of all valid Wordle words. But in this case I set myself the challenge to create all the valid guesses from scratch.&lt;/p&gt;

&lt;h3 id=&quot;patterns&quot;&gt;Patterns&lt;/h3&gt;

&lt;p&gt;First, let‚Äôs look at some of the rules. There are 8 characters you can fill, and the final part will always be:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;=N&lt;/code&gt; with N is a single digit number between 0-9&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;=NN&lt;/code&gt; with NN being between 10 and 99; or&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;=NNN&lt;/code&gt; with NNN being between 100 and 999&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;It‚Äôs easy to generate all those options. However: the part before that is a little bit harder.&lt;/p&gt;

&lt;p&gt;Calculations can, because of the limited size, be just one of two patterns (of various sizes):
&lt;code class=&quot;highlighter-rouge&quot;&gt;Value1 Operator Value2&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;Value1 Operator Value2 Operator Value3&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;For example &lt;code class=&quot;highlighter-rouge&quot;&gt;12+34=46&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;10/2+1=6&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;These patterns are build up from left to right, starting first with a single digit number, appending the first operator, etc, until we have all valid 4, 5 or 6-character calculations.&lt;/p&gt;

&lt;p&gt;Now obviously, the tricky part is that we need to evaluate all these calculations and check if the result fits in the amount of characters we have left, for example &lt;code class=&quot;highlighter-rouge&quot;&gt;=NN&lt;/code&gt;! This code isn‚Äôt pretty‚Ä¶ at all, even though I tried to make it generic. I won‚Äôt share it haha.&lt;/p&gt;

&lt;h3 id=&quot;bugsproblems&quot;&gt;Bugs/problems&lt;/h3&gt;

&lt;p&gt;I quickly ran into the first big obstacle: How do you calculate the result of something like &lt;code class=&quot;highlighter-rouge&quot;&gt;1+10/2&lt;/code&gt;? You‚Äôll first need to evaluate &lt;code class=&quot;highlighter-rouge&quot;&gt;10/2&lt;/code&gt;, store the result, and finally do &lt;code class=&quot;highlighter-rouge&quot;&gt;1+5&lt;/code&gt; and check if &lt;code class=&quot;highlighter-rouge&quot;&gt;=6&lt;/code&gt; fits (which it does).&lt;/p&gt;

&lt;p&gt;After writing some code and making sure we always evaluate in the correct order in case of &lt;code class=&quot;highlighter-rouge&quot;&gt;Value1 Operator Value2 Operator Value3&lt;/code&gt; I thought we were done. It showed me there are about 13k valid guesses. And this was wrong.&lt;/p&gt;

&lt;p&gt;The first bug I encountered was silly. I falsely put in a rule that no result can be zero. But in some cases zero‚Äôs are allowed, for example ending with &lt;code class=&quot;highlighter-rouge&quot;&gt;=0&lt;/code&gt;. After fixing this bug I found out I was still missing some valid guesses.&lt;/p&gt;

&lt;p&gt;After diff-ing my list with a list I found online I noticed I was missing things like: &lt;code class=&quot;highlighter-rouge&quot;&gt;9/6*8=12&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Because Nerdle doesn‚Äôt handle fractions, I thought that the divides should never have remainders. Thus I marked &lt;code class=&quot;highlighter-rouge&quot;&gt;9/6&lt;/code&gt; invalid because it doesn‚Äôt evenly divide. However‚Ä¶ we are multiplying afterwards (!) so the &lt;em&gt;actual&lt;/em&gt; result (12) &lt;strong&gt;IS&lt;/strong&gt; a valid guess for Nerdle.&lt;/p&gt;

&lt;h3 id=&quot;results&quot;&gt;Results&lt;/h3&gt;

&lt;p&gt;After fixing all the bugs I had a complete list of all valid Nerdle guesses, and here are some stats:&lt;/p&gt;

&lt;p&gt;There are 17723 valid Nerdle answers&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;6839 of which contain a &lt;code class=&quot;highlighter-rouge&quot;&gt;+&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;7810 of which contain a &lt;code class=&quot;highlighter-rouge&quot;&gt;-&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;5574 of which contain a &lt;code class=&quot;highlighter-rouge&quot;&gt;*&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;4024 of which contain a &lt;code class=&quot;highlighter-rouge&quot;&gt;/&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;8607 of which contain two math operators&lt;/li&gt;
  &lt;li&gt;5890 end with &lt;code class=&quot;highlighter-rouge&quot;&gt;=N&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;10515 end with &lt;code class=&quot;highlighter-rouge&quot;&gt;=NN&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;1318 of which end with &lt;code class=&quot;highlighter-rouge&quot;&gt;=NNN&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;And when I fired up the Wordle-checker, my code thinks the best start is:
&lt;code class=&quot;highlighter-rouge&quot;&gt;49-37=12&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Other great starters are:
&lt;code class=&quot;highlighter-rouge&quot;&gt;39-24=15&lt;/code&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;34+27=61&lt;/code&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;9+8/2=13&lt;/code&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;7+8-13=2&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;After writing the bot I‚Äôve tried it against the last three Nerdle challenges, and each game was solved after just three guesses!&lt;/p&gt;

&lt;p&gt;For example yesterday the bot calculated the following guesses:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;49-37=12 : ‚¨õ‚¨õüü©üü™üü™üü™üü™‚¨õ
31+56=87 : üü™üü©‚¨õ‚¨õ‚¨õüü™‚¨õüü©
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After just these two guesses there is only &lt;strong&gt;ONE&lt;/strong&gt; valid guess left: &lt;code class=&quot;highlighter-rouge&quot;&gt;11-1-3=7&lt;/code&gt;: üü©üü©üü©üü©üü©üü©üü©üü©&lt;/p&gt;

</description>
        <pubDate>Thu, 03 Mar 2022 08:01:25 +0100</pubDate>
        <link>https://royvanrijn.com/blog/2022/03/wordle-to-nerdle/</link>
        <guid isPermaLink="true">https://royvanrijn.com/blog/2022/03/wordle-to-nerdle/</guid>
        
        <category>java</category>
        
        <category>nerdle</category>
        
        <category>wordle</category>
        
        <category>puzzle</category>
        
        <category>algorithm</category>
        
        
        <category>Programming</category>
        
      </item>
    
      <item>
        <title>An algorithm for Wordle</title>
        <description>&lt;p&gt;If you‚Äôve used Twitter during the begining of 2022 you‚Äôll almost certainly have seen people posting tweets like this:&lt;/p&gt;

&lt;pre&gt;
Wordle 202 3/6

‚¨ú‚¨ú‚¨ú‚¨úüü®
üü®‚¨ú‚¨ú‚¨ú‚¨ú
üü©üü©üü©üü©üü©
&lt;/pre&gt;

&lt;p&gt;This is the result of playing the latest viral game ‚ÄúWordle‚Äù. The concept is very easy, you have to guess a 5-letter word each day. For each guess you get the basic ‚ÄúMastermind‚Äù reply, green for the correct character, yellow if it‚Äôs in the wrong spot.&lt;/p&gt;

&lt;p&gt;This game was fun, for a couple of days, but my curious mind started to wonder‚Ä¶ what are the &lt;em&gt;BEST&lt;/em&gt; words to play?&lt;/p&gt;

&lt;p&gt;So I downloaded a huge list of 5-character words and started playing around with the dataset.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Update:&lt;/strong&gt; I‚Äôve updated the post using the ‚Äòcorrect‚Äô Wordle word-list, there are two lists, one with possible secret words, and one list with all words valid for guessing.&lt;/p&gt;

&lt;h1 id=&quot;eliminate-by-frequency&quot;&gt;Eliminate by frequency&lt;/h1&gt;

&lt;p&gt;The first thing I tried was to try and eliminate the most frequently used characters first. With 5 guesses we can try and guess the most frequently present letters in the English language.&lt;/p&gt;

&lt;p&gt;To get the frequency of the letters I used the following code:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;        &lt;span class=&quot;c1&quot;&gt;// Read all the words:&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;words&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;readAllLines&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;wordle.txt&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// Count all the characters frequencies:&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Character&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Long&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frequency&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;words&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;flatMapToInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;w&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mapToObj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;collect&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Collectors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;groupingBy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
                        &lt;span class=&quot;nc&quot;&gt;Function&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;identity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt;
                        &lt;span class=&quot;nc&quot;&gt;Collectors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;counting&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// Sort the characters by frequency and print:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;frequency&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;entrySet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sorted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Long&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()))&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;forEach&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getKey&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This results in the following distribution:&lt;/p&gt;

&lt;pre&gt;
s 6665
e 6662
a 5990
o 4438
r 4158
i 3759
l 3371
t 3295
n 2952
u 2511
d 2453
y 2074
c 2028
p 2019
m 1976
h 1760
g 1644
b 1627
k 1505
... (etc)
&lt;/pre&gt;

&lt;p&gt;Using some simple code it‚Äôs easy to find &lt;em&gt;pretty good&lt;/em&gt; words to start with, for example:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;laser -&amp;gt; tonic -&amp;gt; dumpy&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;These &lt;strong&gt;three&lt;/strong&gt; guesses will tell you information about the 15 most common characters in all of the 5-letter words. This is ‚Äúa‚Äù strategy, but it‚Äôs far from perfect. We can do much better!&lt;/p&gt;

&lt;h1 id=&quot;most-information-per-guess&quot;&gt;Most information per guess&lt;/h1&gt;

&lt;p&gt;Each time we guess a word, we get a reply back, it can be something like ‚Äú‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚Äù or ‚Äúüü®‚¨ú‚¨úüü©üü®‚Äù. What we want to do is &lt;em&gt;optimize&lt;/em&gt; for the information we‚Äôre getting in return. Each guess we do should eliminate most options.&lt;/p&gt;

&lt;p&gt;If we go over the entire list of words, and compare all the replies we could get back against all other words, we get a distribution of the returned patterns.&lt;/p&gt;

&lt;p&gt;I‚Äôve decided to write some code to do this. For example if we pick the word &lt;code class=&quot;highlighter-rouge&quot;&gt;smile&lt;/code&gt;, these patterns can be returned:&lt;/p&gt;

&lt;pre&gt;
üü®‚¨ú‚¨ú‚¨ú‚¨ú: 1464 ‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú: 1352 ‚¨ú‚¨ú‚¨ú‚¨úüü®: 1122 üü®‚¨ú‚¨ú‚¨úüü®:  967 ‚¨ú‚¨úüü®‚¨ú‚¨ú:  690 ‚¨ú‚¨ú‚¨úüü®‚¨ú:  610 
‚¨ú‚¨ú‚¨ú‚¨úüü©:  504 üü®‚¨úüü®‚¨ú‚¨ú:  468 üü©‚¨ú‚¨ú‚¨ú‚¨ú:  467 ‚¨úüü®‚¨ú‚¨ú‚¨ú:  417 üü®‚¨ú‚¨úüü®‚¨ú:  263 üü©‚¨ú‚¨ú‚¨úüü®:  252 
‚¨ú‚¨úüü®‚¨úüü®:  251 ‚¨ú‚¨úüü©‚¨ú‚¨ú:  196 üü®üü®‚¨ú‚¨ú‚¨ú:  191 üü®‚¨úüü©‚¨ú‚¨ú:  187 ‚¨ú‚¨ú‚¨úüü®üü®:  183 ‚¨ú‚¨úüü®üü®‚¨ú:  154 
‚¨úüü®‚¨ú‚¨úüü®:  154 üü®‚¨úüü®‚¨úüü®:  147 üü®‚¨ú‚¨ú‚¨úüü©:  136 ‚¨ú‚¨úüü®‚¨úüü©:  136 ‚¨ú‚¨ú‚¨úüü©‚¨ú:  128 üü®‚¨ú‚¨úüü©‚¨ú:  117 
‚¨úüü®üü®‚¨ú‚¨ú:  115 ‚¨ú‚¨ú‚¨úüü®üü©:  115 üü©‚¨úüü®‚¨ú‚¨ú:  112 üü©‚¨ú‚¨ú‚¨úüü©:  109 üü©‚¨ú‚¨úüü®‚¨ú:  107 ‚¨úüü®‚¨úüü®‚¨ú:  106 
‚¨úüü®‚¨ú‚¨úüü©:   99 üü©‚¨úüü©‚¨ú‚¨ú:   87 ‚¨ú‚¨úüü©‚¨úüü©:   82 ‚¨ú‚¨ú‚¨úüü©üü©:   79 üü©üü®‚¨ú‚¨ú‚¨ú:   63 ‚¨ú‚¨úüü©üü®‚¨ú:   63 
üü®‚¨ú‚¨úüü®üü®:   62 ‚¨ú‚¨úüü©‚¨úüü®:   58 üü®üü®‚¨ú‚¨úüü®:   53 ‚¨ú‚¨ú‚¨úüü©üü®:   52 üü®‚¨ú‚¨úüü©üü®:   49 ‚¨ú‚¨úüü®üü©‚¨ú:   46 
üü©‚¨ú‚¨úüü©‚¨ú:   43 üü®‚¨úüü©‚¨úüü®:   41 üü©‚¨úüü®‚¨úüü®:   41 üü®‚¨úüü®üü©‚¨ú:   36 ‚¨ú‚¨úüü©üü©‚¨ú:   35 ‚¨úüü®üü©‚¨ú‚¨ú:   31 
üü©‚¨úüü©‚¨úüü©:   27 ‚¨úüü©‚¨ú‚¨úüü®:   27 üü©‚¨ú‚¨úüü®üü®:   27 üü®‚¨úüü©üü©‚¨ú:   25 üü®‚¨úüü©üü®‚¨ú:   25 ‚¨úüü®‚¨úüü©‚¨ú:   23 
üü©‚¨ú‚¨úüü©üü®:   20 üü®üü©‚¨ú‚¨ú‚¨ú:   20 üü®‚¨úüü©‚¨úüü©:   19 üü®üü®üü©‚¨ú‚¨ú:   19 ‚¨ú‚¨úüü®üü®üü©:   18 üü©‚¨úüü©‚¨úüü®:   18 
üü©‚¨ú‚¨úüü©üü©:   18 üü©üü©‚¨ú‚¨ú‚¨ú:   18 üü©‚¨úüü®üü®‚¨ú:   17 ‚¨ú‚¨úüü®üü®üü®:   17 ‚¨ú‚¨úüü©üü®üü©:   15 ‚¨úüü©‚¨ú‚¨ú‚¨ú:   15 
‚¨úüü©üü®‚¨ú‚¨ú:   15 ‚¨ú‚¨úüü©üü©üü©:   14 üü©‚¨ú‚¨úüü®üü©:   14 üü©‚¨úüü©üü©‚¨ú:   13 üü©‚¨úüü©üü®‚¨ú:   13 ‚¨úüü®üü©‚¨úüü©:   13 
üü©üü®‚¨ú‚¨úüü®:   13 üü©üü®üü©‚¨ú‚¨ú:   12 ‚¨ú‚¨úüü®üü©üü©:   12 üü®üü®‚¨úüü®‚¨ú:   11 ‚¨úüü©üü©‚¨ú‚¨ú:   11 ‚¨úüü©‚¨ú‚¨úüü©:   11 
‚¨úüü®üü®‚¨úüü©:   10 üü©üü®üü®‚¨ú‚¨ú:   10 üü®üü©üü©‚¨ú‚¨ú:   10 ‚¨úüü®‚¨úüü©üü©:    9 üü®‚¨úüü®‚¨úüü©:    9 üü®‚¨ú‚¨úüü®üü©:    9 
üü©‚¨úüü®‚¨úüü©:    8 üü©üü®‚¨ú‚¨úüü©:    7 üü®‚¨úüü®üü®‚¨ú:    7 ‚¨úüü®üü®üü®‚¨ú:    7 üü®üü®üü®‚¨ú‚¨ú:    7 üü®‚¨úüü©üü©üü®:    6 
üü©‚¨úüü®üü©‚¨ú:    6 ‚¨úüü©üü©‚¨úüü©:    5 üü©üü©‚¨ú‚¨úüü®:    5 ‚¨úüü©‚¨úüü©üü©:    5 üü©üü©‚¨ú‚¨úüü©:    5 üü®üü©‚¨ú‚¨úüü®:    5 
üü©üü©üü©‚¨ú‚¨ú:    5 ‚¨úüü®‚¨úüü®üü©:    4 üü®‚¨ú‚¨úüü©üü©:    4 ‚¨úüü©üü®‚¨úüü®:    4 üü©üü©‚¨úüü©‚¨ú:    4 üü®üü®‚¨ú‚¨úüü©:    4 
üü©‚¨úüü©üü®üü©:    4 ‚¨úüü©üü®‚¨úüü©:    3 ‚¨úüü©‚¨úüü®‚¨ú:    3 üü©üü®‚¨úüü®‚¨ú:    3 üü©‚¨úüü©üü©üü©:    3 ‚¨úüü®üü©üü©üü©:    2 
üü©üü®üü©‚¨úüü©:    2 üü®‚¨úüü®üü©üü©:    2 ‚¨ú‚¨úüü©üü©üü®:    2 üü©üü©üü®‚¨ú‚¨ú:    2 üü©üü©‚¨úüü©üü®:    2 üü®üü©üü®‚¨ú‚¨ú:    2 
‚¨úüü©‚¨úüü©‚¨ú:    2 ‚¨ú‚¨úüü©üü®üü®:    2 üü©üü®‚¨úüü©‚¨ú:    2 ‚¨úüü®‚¨úüü©üü®:    1 ‚¨úüü©üü®üü®üü®:    1 ‚¨úüü®üü®‚¨úüü®:    1 
üü©‚¨úüü®üü©üü©:    1 ‚¨úüü®‚¨úüü®üü®:    1 üü©üü®üü®‚¨úüü©:    1 ‚¨úüü®üü®üü©‚¨ú:    1 üü®üü©‚¨úüü®‚¨ú:    1 üü©üü©üü©üü©üü©:    1 
üü®üü©‚¨ú‚¨úüü©:    1 üü©üü®‚¨úüü©üü®:    1 ‚¨ú‚¨úüü®üü©üü®:    1 üü©üü©üü©‚¨úüü©:    1 üü®üü©‚¨úüü©‚¨ú:    1 üü®‚¨úüü©üü©üü©:    1 
üü®üü©üü©‚¨úüü®:    1 ‚¨úüü©üü®üü©‚¨ú:    1 üü®üü®‚¨úüü©‚¨ú:    1 ‚¨úüü®üü©üü©‚¨ú:    1 üü©‚¨úüü©üü©üü®:    1 ‚¨úüü©üü®üü®‚¨ú:    1 
&lt;/pre&gt;

&lt;p&gt;This means that, if we pick &lt;code class=&quot;highlighter-rouge&quot;&gt;smile&lt;/code&gt;, we can get &lt;strong&gt;101&lt;/strong&gt; different resulting patterns. The largest group we‚Äôre left with contains &lt;strong&gt;316&lt;/strong&gt; words. So by guessing this single word, we can eliminate most of the words.&lt;/p&gt;

&lt;p&gt;If we do this for &lt;em&gt;all&lt;/em&gt; the words, my algorithm gives back that &lt;code class=&quot;highlighter-rouge&quot;&gt;raise&lt;/code&gt; is &lt;em&gt;the&lt;/em&gt; absolute best first word. This word returns 107 different patterns and the &lt;em&gt;worst&lt;/em&gt; case is that we have 168 words left after the initial guess.&lt;/p&gt;

&lt;p&gt;Another good candidate would be &lt;code class=&quot;highlighter-rouge&quot;&gt;slate&lt;/code&gt;, this splits the words into &lt;em&gt;more&lt;/em&gt; groups: 129. But the worst-case is a little bit worse, leaving just 221 words.&lt;/p&gt;

&lt;h2 id=&quot;after-raise-repeat&quot;&gt;After &lt;code class=&quot;highlighter-rouge&quot;&gt;raise&lt;/code&gt;, repeat.&lt;/h2&gt;

&lt;p&gt;After our first guess, we just continue with the following guesses. We calculate which words are still left and we go over &lt;strong&gt;all&lt;/strong&gt; the words to find the one that gives us most &lt;em&gt;information&lt;/em&gt; about the target word. Also: Don‚Äôt limit yourself to using/guessing just the possible words. For example look at the following case:&lt;/p&gt;

&lt;pre&gt;
tares: üü®‚¨ú‚¨ú‚¨ú‚¨ú
pilot: ‚¨úüü©‚¨ú‚¨úüü®
dunsh: ‚¨ú‚¨ú‚¨ú‚¨úüü©
&lt;/pre&gt;

&lt;p&gt;There are now still eight possible words:&lt;/p&gt;

&lt;pre&gt;
hitch, fifth, witch, aitch, bitch, fitch, gitch, mitch
&lt;/pre&gt;

&lt;p&gt;Instead of guessing one of these words, often getting just a single piece of information‚Ä¶ it‚Äôs much better to guess the word &lt;code class=&quot;highlighter-rouge&quot;&gt;awful&lt;/code&gt;. This guess splits the possible words into &lt;strong&gt;5&lt;/strong&gt; groups:&lt;/p&gt;

&lt;pre&gt;
üü©‚¨ú‚¨ú‚¨ú‚¨ú: aitch
‚¨úüü®‚¨ú‚¨ú‚¨ú: witch
‚¨ú‚¨úüü©‚¨ú‚¨ú: fifth
‚¨ú‚¨úüü®‚¨ú‚¨ú: fitch
‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú: hitch, bitch, gitch, mitch
&lt;/pre&gt;

&lt;p&gt;If we get ‚¨úüü®‚¨ú‚¨ú‚¨ú in return we can conclude that the only option left to guess is &lt;code class=&quot;highlighter-rouge&quot;&gt;witch&lt;/code&gt; and we‚Äôre done üü©üü©üü©üü©üü©.&lt;/p&gt;

&lt;p&gt;This algorithm allows me to solve all words within the given 6 tries you get with Wordle. For a single move I think this algorithm is optimal. However, we might be able to do better if we consider multiple moves into the future. It should be possible to extend this, build a tree and check the depth.&lt;/p&gt;

&lt;p&gt;Perhaps &lt;code class=&quot;highlighter-rouge&quot;&gt;raise&lt;/code&gt; is great for a single move, eliminating a lot of options, but what if the largest (worst-case) group is very hard to break up after that?&lt;/p&gt;

&lt;p&gt;I haven‚Äôt tried to figure this out‚Ä¶ but perhaps you will? What other algorithms can we come up with?&lt;/p&gt;

&lt;h1 id=&quot;bot-tournament&quot;&gt;Bot tournament‚Ä¶?&lt;/h1&gt;

&lt;p&gt;Perhaps we can host a tournament where we have bots playing &lt;em&gt;Wordle&lt;/em&gt;, taking turns solving and giving the opponent a next word to solve. We can even make the bots smart enough to recognise and counter certain words and/or tactics.&lt;/p&gt;

&lt;p&gt;Sounds fun :)&lt;/p&gt;

</description>
        <pubDate>Fri, 07 Jan 2022 08:01:25 +0100</pubDate>
        <link>https://royvanrijn.com/blog/2022/01/wordle-bot/</link>
        <guid isPermaLink="true">https://royvanrijn.com/blog/2022/01/wordle-bot/</guid>
        
        <category>java</category>
        
        <category>wordle</category>
        
        <category>puzzle</category>
        
        <category>algorithm</category>
        
        
        <category>Programming</category>
        
      </item>
    
      <item>
        <title>Divide by three using shift and add</title>
        <description>&lt;p&gt;Today I stumbled across this excellent short video bij Mathologer:&lt;/p&gt;

&lt;iframe type=&quot;text/html&quot; width=&quot;640&quot; height=&quot;390&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;&quot; mozallowfullscreen=&quot;&quot; allowfullscreen=&quot;&quot; src=&quot;https://www.youtube.com/embed/SOBz-aFOH2I?title=0&amp;amp;byline=0&amp;amp;portrait=0&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;This simple proof shows that 1/3 is the same as: 1/4 + 1/4^2 + 1/4^3 + 1/4^N‚Ä¶&lt;/p&gt;

&lt;p&gt;As a programmer I wanted to try and program this.&lt;/p&gt;

&lt;p&gt;Dividing by multiples of two (like 4^3) is extremely easy in binary, we just shift a number to the right. So if you have some integer X and we want to divide by 4, we do &lt;code class=&quot;highlighter-rouge&quot;&gt;X &amp;gt;&amp;gt; 2&lt;/code&gt;, if we want to divide by 4^2 we shift &lt;code class=&quot;highlighter-rouge&quot;&gt;X &amp;gt;&amp;gt; 4&lt;/code&gt; etc.&lt;/p&gt;

&lt;p&gt;This means we can just add these fractions together and approximate the result, just by dividing (shifting) up to &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;gt;&amp;gt; 30&lt;/code&gt; for an integer (which is 32-bit).&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;612644632&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// Approximate Using: 1/3 = 1/4 + 1/4^2 + 1/4^3 + etc&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;divless&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; / 3     = &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; + magic = &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;divless&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// 612644632 / 3     = 204214877&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// 612644632 + magic = 204214872 &amp;lt;- close, a bit too low&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The accuracy isn‚Äôt great‚Ä¶ but it‚Äôs pretty close. We‚Äôre always a bit below the actual sum because for each part we add, we lose a bit of information which we‚Äôre shifted away. To counter this we could first add things and shift the final result, making the accuracy a bit better:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;612644632&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// Approximate Using: 1/3 = 1/4 + 1/4^2 + 1/4^3 + etc&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;divless&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; / 3     = &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bignr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; + magic = &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;divless&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// 612644632 / 3     = 204214877&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// 612644632 + magic = 204214876 &amp;lt;- off by one haha&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Probably a useless trick, but fun nonetheless.&lt;/p&gt;
</description>
        <pubDate>Fri, 31 Dec 2021 09:01:25 +0100</pubDate>
        <link>https://royvanrijn.com/blog/2021/12/divide-by-three/</link>
        <guid isPermaLink="true">https://royvanrijn.com/blog/2021/12/divide-by-three/</guid>
        
        <category>java</category>
        
        <category>trick</category>
        
        <category>math</category>
        
        <category>divide</category>
        
        
        <category>Programming</category>
        
      </item>
    
      <item>
        <title>Hex grid in single integer</title>
        <description>&lt;h2 id=&quot;azspcs-ap-math&quot;&gt;AZsPCs: AP Math&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://azspcs.com/&quot;&gt;Al Zimmermann&lt;/a&gt; hosts awesome Programming Contests every once in a while. They usually run for a long time (multiple months) and it allows mathematicians and programmers to compete in optimization problems. Usually the search space is very large and optimal solutions aren‚Äôt found for large N-values.&lt;/p&gt;

&lt;p&gt;This time the contest was called ‚ÄúAP Math‚Äù and the goal was:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Given a hexagonal grid of size N, select the maximum amount of cells so no three cells form an arithmetic progression.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/images/azspcs-ap-math.png&quot; alt=&quot;Description of contest&quot; /&gt;&lt;/p&gt;

&lt;p&gt;During this contest I didn‚Äôt find the right way to attack the problem, but I did discover a clever way to store all the hex coordinates in a singe integer value and do the math on that; which I wanted to share here.&lt;/p&gt;

&lt;!--more--&gt;

&lt;h2 id=&quot;arithmetic-progression&quot;&gt;Arithmetic progression?&lt;/h2&gt;

&lt;p&gt;The main goal in the contest is to select cells in a hex grid with this one rule ‚Äúno three cells form an arithmetic progression‚Äù.&lt;/p&gt;

&lt;p&gt;What does this mean? If you look at the example above for a N=3 hex grid you can see that we have to select cells, with the rule that no two points can have another cell in between, on the mid point.&lt;/p&gt;

&lt;p&gt;Look at this website for more examples and a complete description: &lt;a href=&quot;http://azspcs.com/Contest/APMath&quot;&gt;AP Math&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;So to find solutions, we need a way to store the coordinates of this hex grid and a way to determine given two cells, which other cells are illegal.&lt;/p&gt;

&lt;h2 id=&quot;storing-coordinates-as-single-32-bit-integer&quot;&gt;Storing coordinates as single 32-bit integer&lt;/h2&gt;

&lt;p&gt;There are multiple ways to store the coordinates of an hexagonal grid. The best write-up I‚Äôve found is located at &lt;a href=&quot;https://www.redblobgames.com/grids/hexagons/&quot;&gt;redblobgames.com&lt;/a&gt;. I‚Äôm using an axial grid, so each coordinate has an &lt;code class=&quot;highlighter-rouge&quot;&gt;x&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;y&lt;/code&gt; value.&lt;/p&gt;

&lt;p&gt;But &lt;strong&gt;instead&lt;/strong&gt; of working with an &lt;code class=&quot;highlighter-rouge&quot;&gt;x&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;y&lt;/code&gt; value, I‚Äôm storing each coordinate as a &lt;em&gt;single&lt;/em&gt; 32-bit integer.&lt;/p&gt;

&lt;p&gt;To generate all of them I used the following (Java) code:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;S&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nc&quot;&gt;Set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;indexes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HashSet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;();&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// Generate all hex points: (as single int)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// Cut off the two triangular edges to make a hex grid:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;indexes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//&amp;lt;-- store all the positions x, y both into a single integer value.&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As you can see, I‚Äôm storing &lt;code class=&quot;highlighter-rouge&quot;&gt;x&lt;/code&gt; &lt;em&gt;and&lt;/em&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;y&lt;/code&gt; in a single integer value, shifted 16 bits.&lt;/p&gt;

&lt;p&gt;Now you might ask: how is storing each coordinate as a single 32-bit value useful? What does it add?&lt;/p&gt;

&lt;p&gt;Well, suppose we have two coordinates from the complete list of all hex grid coordinates mentioned above. With these two indexes in our hex grid we can do the following:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;c1&quot;&gt;// A bitmask to check for even numbers&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;BOTH_EVEN_MASK&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;^&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;BOTH_EVEN_MASK&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Points index1 and index2 has the following midpoint:&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;invalidMid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;invalid1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;invalid2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Using very limited control code and little math we can calculate all three points that are needed for this contest. Given just the two coordinates we get the two or three points that are invalidated. This is much faster than any other coordinate system I tried. A single subtract of two indexes gives the &lt;code class=&quot;highlighter-rouge&quot;&gt;x&lt;/code&gt; &lt;em&gt;and&lt;/em&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;y&lt;/code&gt; of the new point: less work for the CPU.&lt;/p&gt;

&lt;p&gt;Turns out, I didn‚Äôt even need to use the actual &lt;code class=&quot;highlighter-rouge&quot;&gt;x&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;y&lt;/code&gt; values anywhere, I could stay in this coordinate-system while searching. If you want to though, just mask and shift:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xFFFF&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xFFFF&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This was my little ‚Äòhack‚Äô for this contest. I might be able to use this &lt;code class=&quot;highlighter-rouge&quot;&gt;xy&lt;/code&gt; as a single integer on more occasions, in other contests. It‚Äôs a nice tool to have in the toolbox.&lt;/p&gt;

</description>
        <pubDate>Tue, 28 Dec 2021 11:19:31 +0100</pubDate>
        <link>https://royvanrijn.com/blog/2021/12/hex-grid-coordinates-in-a-single-integer/</link>
        <guid isPermaLink="true">https://royvanrijn.com/blog/2021/12/hex-grid-coordinates-in-a-single-integer/</guid>
        
        <category>java</category>
        
        <category>hex grid</category>
        
        <category>azspcs</category>
        
        
        <category>Programming</category>
        
      </item>
    
      <item>
        <title>Log4Shell / Leak4J</title>
        <description>&lt;p&gt;Bert Jan Schrijver and I did a livestream showcasing Log4Shell and talking about the vulnerability, check it out here:&lt;/p&gt;

&lt;iframe type=&quot;text/html&quot; width=&quot;640&quot; height=&quot;390&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;&quot; mozallowfullscreen=&quot;&quot; allowfullscreen=&quot;&quot; src=&quot;https://www.youtube.com/embed/TX1SF2dhMc4?title=0&amp;amp;byline=0&amp;amp;portrait=0&quot;&gt;&lt;/iframe&gt;

&lt;h2 id=&quot;what-is-log4shell&quot;&gt;What is Log4Shell?&lt;/h2&gt;

&lt;p&gt;Last couple of days (and nights) I‚Äôve been studying the new (extremely dangerous) vulnerability in log4j2 called &lt;a href=&quot;https://en.wikipedia.org/wiki/Log4Shell)&quot;&gt;Log4Shell&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;All versions of log4j-core from 2.0-beta9 to 2.14.1 are affected by this, and it‚Äôs a &lt;strong&gt;big&lt;/strong&gt; one.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;This vulnerability allows the attacker to remotely execute code on your system, with the ability to get complete control of the underlying servers.&lt;/p&gt;

&lt;p&gt;Log4J has, for a long time, been the most used logging framework in the Java landscape. It‚Äôs extremely widely used and this attack has the most broad trigger you can imagine: It needs to log something.&lt;/p&gt;

&lt;p&gt;The payload can be delivered in a LOT of ways, as long as it gets in a log statement. Either through user-controlled fields, HTTP requests, URLs, &lt;strong&gt;ANYTHING&lt;/strong&gt;.&lt;/p&gt;

&lt;h2 id=&quot;the-attack&quot;&gt;The attack&lt;/h2&gt;

&lt;p&gt;After writing some code (a malicious embedded LDAP server) I was able to reproduce the RCE (‚ÄúRemote Code Execution‚Äù) attack on even the most basic project.&lt;/p&gt;

&lt;p&gt;Here is an example: a simple REST endpoint in a Spring Boot starter project with a single line of logging&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/leak4j1.png&quot; alt=&quot;Leak4J&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As you can see it downloads and executes a classfile I‚Äôm serving from the malicious LDAP server (running seperately) printing a message.&lt;/p&gt;

&lt;p&gt;I‚Äôll not be sharing the malicious code, it‚Äôs just too simple to set up and abuse. There are better and easier ways to check if your software is vulnerable. For example using this tool by &lt;a href=&quot;https://log4j-tester.trendmicro.com/&quot;&gt;Trend Micro&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;possible-risks-&quot;&gt;Possible risks: üö®&lt;/h2&gt;

&lt;p&gt;Risks of this vulnerability are:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Loss of &lt;em&gt;ALL&lt;/em&gt; data&lt;/li&gt;
  &lt;li&gt;Ransomware&lt;/li&gt;
  &lt;li&gt;Backdoors&lt;/li&gt;
  &lt;li&gt;Botnet&lt;/li&gt;
  &lt;li&gt;Loss of AWS/Kubernetes keys/secrets&lt;/li&gt;
  &lt;li&gt;And the list goes on, and on, and on‚Ä¶&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;the-fix&quot;&gt;The fix&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;Option 1&lt;/strong&gt;: If you haven‚Äôt already: upgrade log4j-core to version &amp;gt;= 2.16.0&lt;/p&gt;

&lt;p&gt;Use version &lt;strong&gt;2.16.0&lt;/strong&gt; instead of 2.15.0, this fixes the problem a bit more rigorously.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;    &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dependency&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;org&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;apache&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;logging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;log4j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;artifactId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log4j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;core&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;artifactId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.16&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dependency&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Do this for all transitive dependencies as well (!).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Option 2&lt;/strong&gt;: Another option is to launch the JRE with.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;    &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Dlog4j2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;formatMsgNoLookups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But be &lt;strong&gt;AWARE&lt;/strong&gt; this flag was put into log4j2 from 2.10.0 onwards. If you have an older version, this does not work.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Option 3&lt;/strong&gt;: Remove JndiLookup.class&lt;/p&gt;

&lt;p&gt;It is also possible to remove &lt;code class=&quot;highlighter-rouge&quot;&gt;org.apache.logging.log4j.core.lookup.JndiLookup&lt;/code&gt; from your log4j JAR files. I don‚Äôt recommend doing this, if you want to go this route it‚Äôs probably easier to just upgrade to &amp;gt;= &lt;em&gt;2.16.0&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Not an option&lt;/strong&gt;:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;A newer Java version&lt;/li&gt;
  &lt;li&gt;Property: &lt;em&gt;com.sun.jndi.ldap.object.trustURLCodebase&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I‚Äôve seen suggestions online that ‚Äònewer‚Äô Java versions are not affected, but this is just &lt;strong&gt;not true&lt;/strong&gt;. Even with the latest Java versions and with &lt;code class=&quot;highlighter-rouge&quot;&gt;trustURLCodebase&lt;/code&gt; set to &lt;code class=&quot;highlighter-rouge&quot;&gt;false&lt;/code&gt;, they would still be able to steal data (for example environment variables) and deserialize objects already known to the classloader. This makes other deserialization RCEs trivial to launch.&lt;/p&gt;

&lt;p&gt;It might be &lt;em&gt;slightly&lt;/em&gt; harder/safer on a newer Java version, but it‚Äôs definitely &lt;strong&gt;NOT&lt;/strong&gt; a fix.&lt;/p&gt;

&lt;p&gt;To show this I‚Äôve taken the latest version of Java 8 (1.8.311) and I‚Äôm using the log4j2 deserialization to craft something that opens the Calculator on my MacBook using other classes known to the vulnerable target:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/leak4j2.png&quot; alt=&quot;Leak4J with latest Java&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Again: The payload is still being deserialized, on the latest Java version.&lt;/p&gt;

&lt;h2 id=&quot;youve-been-compromised&quot;&gt;You‚Äôve been compromised&lt;/h2&gt;

&lt;p&gt;Great, you‚Äôve upgraded and fixed the issue. However: Don‚Äôt stop there, that‚Äôs just step one.&lt;/p&gt;

&lt;p&gt;This leak was known and exploited for a long time, probably weeks before made publicly. And if even I can exploit it in a couple of minutes with my own malicious code: everybody can.&lt;/p&gt;

&lt;p&gt;So here is what you need to do:&lt;/p&gt;

&lt;p&gt;Step 1: &lt;strong&gt;Upgrade&lt;/strong&gt; and fix the leak&lt;/p&gt;

&lt;p&gt;Step 2: &lt;strong&gt;Assume&lt;/strong&gt; everything was &lt;strong&gt;stolen&lt;/strong&gt;: Rotate all your keys&lt;/p&gt;

&lt;p&gt;Step 3: Go in and &lt;strong&gt;analyse&lt;/strong&gt; the &lt;strong&gt;log&lt;/strong&gt; files&lt;/p&gt;

&lt;p&gt;Step 4: If you have set up infra-structure as code: &lt;strong&gt;rebuild&lt;/strong&gt; your &lt;strong&gt;environment&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Step 4: &lt;strong&gt;Redeploy&lt;/strong&gt; all your &lt;strong&gt;applications&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;We &lt;em&gt;HAVE&lt;/em&gt; to take this one seriously. I don‚Äôt want to hear or read a couple of months from now that some company forgot to patch their software. Not another&lt;/p&gt;

&lt;h2 id=&quot;further-reading&quot;&gt;Further reading:&lt;/h2&gt;

&lt;p&gt;Here are some links for more information:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.lunasec.io/docs/blog/log4j-zero-day/&quot;&gt;https://www.lunasec.io/docs/blog/log4j-zero-day/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://snyk.io/blog/find-fix-log4shell-quickly-snyk/&quot;&gt;https://snyk.io/blog/find-fix-log4shell-quickly-snyk/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Log4Shell&quot;&gt;https://en.wikipedia.org/wiki/Log4Shell&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
        <pubDate>Tue, 14 Dec 2021 09:12:31 +0100</pubDate>
        <link>https://royvanrijn.com/blog/2021/12/log4j2-rce-problem/</link>
        <guid isPermaLink="true">https://royvanrijn.com/blog/2021/12/log4j2-rce-problem/</guid>
        
        <category>java</category>
        
        <category>log4j2</category>
        
        <category>logging</category>
        
        <category>rce</category>
        
        <category>vulnerability</category>
        
        
        <category>Programming</category>
        
      </item>
    
      <item>
        <title>Sigh...</title>
        <description>&lt;p&gt;This morning I woke up and saw the following Tweet:&lt;/p&gt;

&lt;blockquote class=&quot;twitter-tweet&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;I&amp;#39;m a bit pissed right now! üò° Why is the world so mean to me, to all of us developers, really? We&amp;#39;ve been so friendly! How often have we written &amp;quot;Hello, world&amp;quot;? And has anybody ever gotten as much as friendly nod in return?&lt;/p&gt;&amp;mdash; Nicolai Parlog (@nipafx) &lt;a href=&quot;https://twitter.com/nipafx/status/1260865259738476547?ref_src=twsrc%5Etfw&quot;&gt;May 14, 2020&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async=&quot;&quot; src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;

&lt;p&gt;And yes, I agree.&lt;/p&gt;

&lt;p&gt;The world has been a pretty shitty friend to us in 2020. Why should all the new programmers/developers have to welcome this messed up world with open arms?&lt;/p&gt;

&lt;p&gt;I say: &lt;strong&gt;Screw You, World.&lt;/strong&gt;&lt;/p&gt;

&lt;!--more--&gt;

&lt;h1 id=&quot;your-first-program&quot;&gt;Your first program&lt;/h1&gt;

&lt;p&gt;My programming language of choice at the moment is &lt;a href=&quot;https://en.wikipedia.org/wiki/Java_(programming_language)&quot;&gt;Java&lt;/a&gt;. So that‚Äôs what I‚Äôll be using for this ‚ÄúScrew You, World‚Äù.&lt;/p&gt;

&lt;p&gt;To get started with Java there are a couple of things you‚Äôll need to &lt;strong&gt;learn&lt;/strong&gt; and &lt;strong&gt;install&lt;/strong&gt; to get it running.&lt;/p&gt;

&lt;p&gt;Let‚Äôs go!&lt;/p&gt;

&lt;h1 id=&quot;java-jdk&quot;&gt;Java JDK&lt;/h1&gt;

&lt;p&gt;There are a lot of places where you can download a so called ‚ÄúJDK‚Äù, which stands for Java Development Kit. This is needed for you to create and build your first Java program.&lt;/p&gt;

&lt;p&gt;For now I won‚Äôt be bothering you with all the different releases and versions, we can just go to &lt;a href=&quot;https://adoptopenjdk.net/&quot;&gt;AdoptOpenJDK&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;And download and install the latest version: OpenJDK 14 (latest)&lt;/p&gt;

&lt;h1 id=&quot;repl-or-class&quot;&gt;REPL or Class&lt;/h1&gt;

&lt;p&gt;Now we have two different options, we can start the Java REPL (read eval print loop) to write Java code interactively, or we can store our code in a so called ‚Äúclass‚Äù-files and run it.&lt;/p&gt;

&lt;p&gt;First we‚Äôll look at the REPL, this is probably the easiest way to write your first ‚ÄúScrew You, World‚Äù.&lt;/p&gt;

&lt;h1 id=&quot;java-repl-jshell&quot;&gt;Java REPL: jshell&lt;/h1&gt;

&lt;p&gt;The interactive code-writing tool in Java is called ‚Äújshell‚Äù and is launched from the Terminal/command line.&lt;/p&gt;

&lt;p&gt;To do this, navigate to the JDK (usually there is a &lt;code class=&quot;highlighter-rouge&quot;&gt;$JAVA_HOME&lt;/code&gt; variable for this) and start:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;	
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;$JAVA_HOME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jshell&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Next you‚Äôll be presented with an interactive shell to write your code in:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;$JAVA_HOME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jshell&lt;/span&gt;   
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;  &lt;span class=&quot;nc&quot;&gt;Welcome&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;JShell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Version&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;14.0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;  &lt;span class=&quot;nc&quot;&gt;For&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;an&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;introduction&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;type:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;help&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;intro&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;jshell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In this little editor you can write any valid Java code you want. Let‚Äôs grab the &lt;code class=&quot;highlighter-rouge&quot;&gt;System&lt;/code&gt; class, get the &lt;code class=&quot;highlighter-rouge&quot;&gt;out&lt;/code&gt; output stream (which defaults to the terminal), and write some text there for the world to see:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;n&quot;&gt;jshell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Screw You, World!&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;Screw&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;You&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;World&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;jshell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And that‚Äôs it. We‚Äôre done.&lt;/p&gt;

&lt;p&gt;Using the REPL we‚Äôve created a line of code which contains a message to 2020.&lt;/p&gt;

&lt;h1 id=&quot;java-class-files&quot;&gt;Java class files&lt;/h1&gt;

&lt;p&gt;The second way to write Java code is to use a text editor (or an IDE, an integrated development environment, like &lt;a href=&quot;https://www.jetbrains.com/idea/&quot;&gt;IntelliJ&lt;/a&gt;) and save the files, compile the files and run the files.&lt;/p&gt;

&lt;p&gt;The code above has little to no real structure. In larger programs we‚Äôll need to create some order in all the code you want to write and run. To do this Java has ‚Äòclasses‚Äô.&lt;/p&gt;

&lt;p&gt;So open any text editor and write your first class file:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ScrewYouWorld&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Save this file as &lt;code class=&quot;highlighter-rouge&quot;&gt;ScrewYouWorld.java&lt;/code&gt;. This is the human-readable version of your code.&lt;/p&gt;

&lt;p&gt;The next step is to take this code and process it, &lt;strong&gt;compile&lt;/strong&gt; it. This turns the readable &lt;code class=&quot;highlighter-rouge&quot;&gt;java&lt;/code&gt; file into a &lt;code class=&quot;highlighter-rouge&quot;&gt;class&lt;/code&gt; file, which is made out of &lt;code class=&quot;highlighter-rouge&quot;&gt;bytecode&lt;/code&gt;. It is still the same code, but optimized for machine readability.&lt;/p&gt;

&lt;p&gt;To do this we call:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;javac&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ScrewYouWorld&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;java&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we‚Äôll get a file named &lt;code class=&quot;highlighter-rouge&quot;&gt;ScrewYouWorld.class&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;This &lt;code class=&quot;highlighter-rouge&quot;&gt;class&lt;/code&gt; file is just en empty shell, it has no real code in it yet and there is not even a valid ‚Äòstarting point‚Äô. When programming in Java there are usually a lot of different classes that make up the application. The code however has to start somewhere, we‚Äôll have to define a starting point.&lt;/p&gt;

&lt;p&gt;In Java there is a very specific &lt;code class=&quot;highlighter-rouge&quot;&gt;method&lt;/code&gt; we need to implement, this makes it a starting point. A &lt;code class=&quot;highlighter-rouge&quot;&gt;method&lt;/code&gt; is a block of code we can call and it does something. The one used to start your code is always called &lt;code class=&quot;highlighter-rouge&quot;&gt;main&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;It looks like this:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ScrewYouWorld&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let‚Äôs break it down. First we have &lt;code class=&quot;highlighter-rouge&quot;&gt;public&lt;/code&gt;, this means any class can access it, which is what we need to start our program.&lt;/p&gt;

&lt;p&gt;Next we have &lt;code class=&quot;highlighter-rouge&quot;&gt;static&lt;/code&gt;. There are TWO kinds of methods in Java, &lt;code class=&quot;highlighter-rouge&quot;&gt;static&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;non-static/member&lt;/code&gt; methods. For now let‚Äôs just say that &lt;code class=&quot;highlighter-rouge&quot;&gt;static&lt;/code&gt; methods are working on a &lt;code class=&quot;highlighter-rouge&quot;&gt;class&lt;/code&gt; level, and &lt;code class=&quot;highlighter-rouge&quot;&gt;non-static&lt;/code&gt; methods are working on the &lt;code class=&quot;highlighter-rouge&quot;&gt;object&lt;/code&gt; level. This is a whole topic for another day. To start we have to make this static, from there we can create new instances.&lt;/p&gt;

&lt;p&gt;Next we have &lt;code class=&quot;highlighter-rouge&quot;&gt;void&lt;/code&gt;, this means that the method we are calling doesn‚Äôt return any results. Some methods calculate something and return a value, like a number or more complex answers.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;main&lt;/code&gt; is a specific name, the name of our method.&lt;/p&gt;

&lt;p&gt;The information between the parentheses are the method ‚Äòarguments‚Äô. These are passed &lt;em&gt;into&lt;/em&gt; the method. Just like arguments you supply to a program. In this case it is an array (list) of Strings.&lt;/p&gt;

&lt;p&gt;This all becomes rather complicated quickly, but we don‚Äôt need to know the specifics right now.&lt;/p&gt;

&lt;p&gt;Next we can add the line we wrote before to inside the method brackets. Classes add a little bit of structure/scaffolding to our applications.&lt;/p&gt;

&lt;p&gt;If we put everything together we‚Äôll end up with:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ScrewYouWorld&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Screw You, World!&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Save this file and compile to bytecode again:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;javac&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ScrewYouWorld&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;java&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can run this code and see the result. We take the compiled &lt;code class=&quot;highlighter-rouge&quot;&gt;class&lt;/code&gt; and the &lt;code class=&quot;highlighter-rouge&quot;&gt;java&lt;/code&gt; command understand that the &lt;code class=&quot;highlighter-rouge&quot;&gt;main&lt;/code&gt; method should be called:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;java&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ScrewYouWorld&lt;/span&gt;      
&lt;span class=&quot;nc&quot;&gt;Screw&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;You&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;World&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Congratulations, we‚Äôve just used two different ways to write and run your first Java program!&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;TODO:&lt;/strong&gt; Add more ‚ÄúScrew You, World.‚Äù examples in different languages.&lt;/p&gt;

</description>
        <pubDate>Thu, 14 May 2020 12:42:11 +0200</pubDate>
        <link>https://royvanrijn.com/blog/2020/05/screw-you-world/</link>
        <guid isPermaLink="true">https://royvanrijn.com/blog/2020/05/screw-you-world/</guid>
        
        <category>java</category>
        
        <category>hello world</category>
        
        
        <category>Programming</category>
        
      </item>
    
      <item>
        <title>OpenAI GPT-2 is amazing</title>
        <description>&lt;p&gt;This week I‚Äôve finally gotten around to research (play with) OpenAI‚Äôs groundbreaking language model &lt;a href=&quot;https://openai.com/blog/better-language-models/&quot;&gt;GPT-2&lt;/a&gt; using &lt;a href=&quot;https://talktotransformer.com/&quot;&gt;talktotransformer.com&lt;/a&gt;.&lt;/p&gt;

&lt;h1 id=&quot;what-is-openai&quot;&gt;What is OpenAI?&lt;/h1&gt;

&lt;p&gt;OpenAI is an AI research organization founded by Elon Musk in January 2016 to explore, develop, and deploy technology for the benefit of humanity. It‚Äôs headquartered in San Francisco, with headquarters in Mountain View, California.&lt;/p&gt;

&lt;h1 id=&quot;and-gpt-2&quot;&gt;And GPT-2?&lt;/h1&gt;

&lt;p&gt;OpenAI recently unveiled a language model called GPT-2 that, given some input text, predicts the coming sentences. GPT-2 also supports the idea of the  ‚ÄúGrammar of Reasoning‚Äù (GRR), in which the model attempts to extract sentences that would make the most intuitive sense, in terms of human understanding. For example, if you input ‚Äúthe dog ate the cat‚Äù and the model predicts ‚Äúdogs eat cats‚Äù, the GRR system would make that sentence as the most probable result. The problem is that even though GRR is very good at answering the question, its predictions are still highly contingent. For example, it is still possible to be a cat-eating dog, and then someone else who doesn‚Äôt eat cats can still eat your dog, but the GRR system would not make such a mistake for the second sentence.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;GPT-2 uses an adaptive model to learn the most relevant concepts to solve complex problems. This is accomplished by using the most relevant words as words, rather than the least relevant words. The model is adaptive to the structure of the content being analyzed.&lt;/p&gt;

&lt;h1 id=&quot;how-does-it-work&quot;&gt;How does it work?&lt;/h1&gt;

&lt;p&gt;There are several components involved in GPT. GPT uses a deep learning based model to understand a large vocabulary.&lt;/p&gt;

&lt;p&gt;The model consists of a neural network, which is composed of multiple layers. Each layer is a separate layer that processes a different input word. GPT uses two neural network layers for each of the following steps:&lt;/p&gt;

&lt;p&gt;First, each layer learns to recognize a particular word. The layers for both input and target are trained together to improve the model‚Äôs performance over time.&lt;/p&gt;

&lt;p&gt;Second, the neural networks are used to predict the target word for the current context. To do this, the first neural network is used to learn about the target word. The target is then used to select a second neural network layer, which is used to predict the word that is closest to the current context.&lt;/p&gt;

&lt;h1 id=&quot;is-the-model-too-powerful&quot;&gt;Is the model too powerful?&lt;/h1&gt;

&lt;p&gt;This is a good question to ask, but it should be taken with a grain of salt. In fact, the GPT-2 is actually quite limited in the way it learns the most relevant concepts. This is in part due to its learning model being a probabilistic algorithm that assumes a model of the world as a probabilistic system. This model is an attempt to describe all the possible states of the world, but the way it learns these states is by taking into account the best model for each state and comparing to that.&lt;/p&gt;

&lt;h1 id=&quot;a-gpt-2-surprise&quot;&gt;A GPT-2 surprise&lt;/h1&gt;

&lt;p&gt;&lt;strong&gt;Surprise!&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This entire blogpost above has been generated by OpenAI‚Äôs GPT-2. I‚Äôve only given the first sentence and the four headers as input. After that I‚Äôve let GPT-2 fill in the blanks (of course I‚Äôve cherry-picked here). The quality is amazing and I‚Äôm pretty sure there are people that made it this far‚Ä¶ and had no clue that what they‚Äôve been reading was 100% generated by a machine.&lt;/p&gt;

&lt;p&gt;Be sure to play around with it at &lt;a href=&quot;https://talktotransformer.com/&quot;&gt;talktotransformer.com&lt;/a&gt;&lt;/p&gt;

</description>
        <pubDate>Wed, 20 Nov 2019 15:42:11 +0100</pubDate>
        <link>https://royvanrijn.com/blog/2019/11/openai-gpt-2/</link>
        <guid isPermaLink="true">https://royvanrijn.com/blog/2019/11/openai-gpt-2/</guid>
        
        <category>gpt2</category>
        
        <category>openai</category>
        
        <category>machine learning</category>
        
        
        <category>OpenAI</category>
        
      </item>
    
      <item>
        <title>Joggling4Trees</title>
        <description>&lt;p&gt;Last week, during a &lt;a href=&quot;https://en.wikipedia.org/wiki/Code_Camp&quot;&gt;code camp&lt;/a&gt; session at work, for some reason the subject of ‚Äújoggling‚Äù came up.&lt;/p&gt;

&lt;h1 id=&quot;what-is-joggling&quot;&gt;What is Joggling?&lt;/h1&gt;

&lt;p&gt;So what is this ‚Äò&lt;a href=&quot;https://en.wikipedia.org/wiki/Joggling&quot;&gt;joggling&lt;/a&gt;‚Äô? The word joggling is a &lt;a href=&quot;https://en.wikipedia.org/wiki/Portmanteau&quot;&gt;portmanteau&lt;/a&gt; of juggling and jogging (running).&lt;/p&gt;

&lt;p&gt;This might sound very strange, but it is an actual sport. There are people joggling marathons (in under three hours!), they are faster while juggling 3 balls than most people (including me) are just running. I‚Äôm probably never running a marathon under three hours.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/joggling.jpg&quot; alt=&quot;A man joggling (not me)&quot; /&gt;&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;I‚Äôve learned how to juggle when I was in my early teens, and it is a skill I‚Äôll never forget, muscle memory. And a couple of years ago I had an annoying knee injury which prevented me from running too far or too fast.&lt;/p&gt;

&lt;p&gt;This is when I learned about joggling. For me it was the perfect way to still enjoy running while not pushing my knees too much. Adding the juggling (3 balls) to my running prevented further injuries, it slowed me down and decreased the distance I was able to run.&lt;/p&gt;

&lt;p&gt;And it is great: Almost everyone gets a smile on their face when I run past them when joggling.&lt;/p&gt;

&lt;h1 id=&quot;the-challenge-bruggenloop-2019&quot;&gt;The challenge: Bruggenloop 2019&lt;/h1&gt;

&lt;p&gt;When I mentioned joggling to my colleagues last week they encouraged me to try it once more.&lt;/p&gt;

&lt;p&gt;We came up with the following challenge:&lt;/p&gt;

&lt;p&gt;&lt;del&gt;On sunday the 8th of december I‚Äôm going to joggle the &lt;a href=&quot;https://www.bruggenloop.nl/english/&quot;&gt;Bruggenloop&lt;/a&gt;, a &lt;strong&gt;15k&lt;/strong&gt; race while juggling &lt;strong&gt;3 balls&lt;/strong&gt;. This will be the first time I‚Äôm joggling a race and it‚Äôll be the first time I‚Äôll joggle for over an hour. I‚Äôve never done more than 10k, heck, I haven‚Äôt been running at all for the last 6 months. So there is quite some work to do now!&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/sad-panda.gif&quot; alt=&quot;Me right now...&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Update:&lt;/strong&gt; I‚Äôve received a &lt;strong&gt;decline&lt;/strong&gt; email from the Bruggenloop organisers. So I‚Äôm going to have to come up with a &lt;em&gt;plan B&lt;/em&gt;. This will likely be a &lt;strong&gt;15k&lt;/strong&gt; run‚Ä¶ by myself, without anyone cheering me on, without providing all the onlookers with a smile.&lt;/p&gt;

&lt;h1 id=&quot;joggling-for-teamtrees&quot;&gt;Joggling for #TeamTrees&lt;/h1&gt;

&lt;p&gt;Because I‚Äôm doing this, my colleagues are donating money to #&lt;a href=&quot;http://teamtrees.org/&quot;&gt;TeamTrees&lt;/a&gt;. This is a charity that, for each dollar, gets a new tree planted. Yes, all 100% of the donations will go towards planting new trees.&lt;/p&gt;

&lt;p&gt;To encourage me not to give up I‚Äôve created the following page &lt;a href=&quot;https://tiltify.com/@royvanrijn/joggling4trees&quot;&gt;Joggling4Trees&lt;/a&gt; where we can track the donations to my cause.&lt;/p&gt;

&lt;p&gt;At the moment we‚Äôve already collected almost 900 dollars, that means &lt;strong&gt;900&lt;/strong&gt; new trees! Which is a freaking &lt;strong&gt;forest&lt;/strong&gt;! I‚Äôm so happy with this, and encourages me to train even harder and make everyone proud!&lt;/p&gt;

&lt;p&gt;But we can do even better‚Ä¶ if you read this, please consider adding a few trees to this planet, every dollar helps!&lt;/p&gt;

&lt;h1 id=&quot;faq&quot;&gt;FAQ&lt;/h1&gt;

&lt;p&gt;Some questions I‚Äôve received about joggling:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Can you drop a ball?&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Yes, this will probably happen a lot, you are not ‚Äòdisqualified‚Äô for dropping a ball, just pick it up and continue from the point you‚Äôve dropped. If a soccer player falls during a match they don‚Äôt automatically lose the game, it is part of the game.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;What is the worst that can happen?&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Losing one or more balls. I‚Äôve had this happen during a training session, one of my balls is now at the bottom of a river. RIP.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;What gear do you need to joggle?&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Running shoes and 3 balls, that‚Äôs it.&lt;/p&gt;

&lt;p&gt;And optionally:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Gloves&lt;/strong&gt; (especially in december, it gets really cold/near freezing), it is hard to joggle when your hands are numb. Transparant &lt;strong&gt;glasses&lt;/strong&gt;, during joggling you tend to not blink as much, and when you run in cold weather this causes a lot of tears to form. Glasses will fix this.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Why would anyone joggle‚Ä¶.?&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Here is an excellent explaination about why &lt;em&gt;everyone&lt;/em&gt; should take up joggling as a sport:&lt;/p&gt;

&lt;iframe type=&quot;text/html&quot; width=&quot;640&quot; height=&quot;390&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;&quot; mozallowfullscreen=&quot;&quot; allowfullscreen=&quot;&quot; src=&quot;https://www.youtube.com/embed/FKiunT8jmHc&quot;&gt;&lt;/iframe&gt;

&lt;h1 id=&quot;one-more-time&quot;&gt;One more time:&lt;/h1&gt;

&lt;p&gt;To support this, plant some trees: &lt;a href=&quot;https://tiltify.com/@royvanrijn/joggling4trees&quot;&gt;Joggling4Trees&lt;/a&gt;&lt;/p&gt;

</description>
        <pubDate>Mon, 18 Nov 2019 09:11:24 +0100</pubDate>
        <link>https://royvanrijn.com/blog/2019/11/joggling-4-trees/</link>
        <guid isPermaLink="true">https://royvanrijn.com/blog/2019/11/joggling-4-trees/</guid>
        
        <category>jogging</category>
        
        <category>juggling</category>
        
        <category>teamtrees</category>
        
        
        <category>Joggling</category>
        
      </item>
    
      <item>
        <title>The world of biased algorithms</title>
        <description>&lt;p&gt;The world is changing, more and more people are openly against racism, against gender discrimination, very much pro equality. People and companies are being called out when they do discriminate and there is a big movement against bias (in general).&lt;/p&gt;

&lt;p&gt;One problematic thing though, for me as a programmer, is the backlash against ‚Äòbiased algorithms‚Äô.&lt;/p&gt;

&lt;h1 id=&quot;algorithms&quot;&gt;Algorithms&lt;/h1&gt;

&lt;p&gt;What are algorithms?&lt;/p&gt;

&lt;p&gt;If you look up the definition &lt;a href=&quot;https://en.wikipedia.org/wiki/Algorithm&quot;&gt;wikipedia&lt;/a&gt; you‚Äôll find:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;A sequence of instructions, typically to solve a class of problems or perform a computation. Algorithms are unambiguous specifications for performing calculation, data processing, automated reasoning, and other tasks.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;In our case today, let‚Äôs define it is a set of instructions that a computer follows so it does a calculation and produces a result. People also do the same thing, they use sets of rules to come to certain conclusions.&lt;/p&gt;

&lt;!--more--&gt;

&lt;h1 id=&quot;bias-in-algorithms&quot;&gt;Bias in algorithms&lt;/h1&gt;

&lt;p&gt;The problem here is &lt;em&gt;bias&lt;/em&gt;. What is the problem with bias in algorithms?&lt;/p&gt;

&lt;p&gt;Suppose we have an algorithm that determines if you do or don‚Äôt get a loan, and also determines the interest rate. This is great, before this system the bank had a human that was responsible for applying/declining loans, now a the computer can do this.&lt;/p&gt;

&lt;p&gt;Now of course, it would be very bad if the programmer and product owners came up with the following rule:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;applicant&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isFemale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;loan&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addInterest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;If is easy to state this rule is discriminating against a particular gender, we &lt;strong&gt;don‚Äôt&lt;/strong&gt; want this discrimination.&lt;/p&gt;

&lt;p&gt;But what if a certain car insurance charges 5% extra for male drivers under 25 with DUI charge? That kind of makes sense, it is &lt;em&gt;still&lt;/em&gt; discrimination though, but we do allow this. It is a slippery slope.&lt;/p&gt;

&lt;p&gt;The good thing though is: The rules are clear. Before there might have been a racist human doing the declines, now it is clear.&lt;/p&gt;

&lt;h1 id=&quot;bias-in-aiml&quot;&gt;Bias in A.I./ML&lt;/h1&gt;

&lt;p&gt;The real problem though starts when you enter the world of AI, big data and machine learning. Now a programmer is no longer writing the readable rules. A machine is using a lot of data to make the best possible decision and find (invisible) correlations.&lt;/p&gt;

&lt;p&gt;What is the ‚Äòbest decision‚Äô? Well, most of the time it is looking at the past, minimizing risk or cost, mimicking human behaviour. This is where a lot of bias comes from and it makes sense.&lt;/p&gt;

&lt;p&gt;If you want everyone to be treated equally, there is no need for a complex algorithm in the first place. The sole purpose of these algorithms is to treat every individual differently based on certain traits. Sometimes we think these traits are obvious and &lt;em&gt;valid&lt;/em&gt;, sometimes we think these traits racist and idiotic, but a computer/A.I. system doesn‚Äôt know the difference.&lt;/p&gt;

&lt;p&gt;A reason A.I. declines a loan:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;People with irregular income and a poor credit history &amp;gt; we‚Äôre okay with this.&lt;/li&gt;
  &lt;li&gt;Female from Easy Kentucky above 40 with a daughter &amp;gt; wait, what?&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The algorithm is probably right though, it is minimizing risk. And while analyzing the given data it found some correlation. This might be because the humans that historically did the job before the algorithm had a certain bias and it was trained on that data, or there actually is a bigger risk for females from East Kentucky based on historic data.&lt;/p&gt;

&lt;h1 id=&quot;minimizing-bad-bias&quot;&gt;Minimizing ‚Äòbad‚Äô bias&lt;/h1&gt;

&lt;p&gt;So there is &lt;strong&gt;good&lt;/strong&gt; and &lt;strong&gt;bad&lt;/strong&gt; bias, how can we use this? Well, if you are training the loan application, give it the ‚Äòright‚Äô data. Train the model with historic data that has income and credit history data, but not the fields for ‚Äòrace‚Äô and ‚Äògender‚Äô.&lt;/p&gt;

&lt;p&gt;There, problem solved.&lt;/p&gt;

&lt;p&gt;Or not? It turns out those A.I. systems are very stubborn in finding correlations. If we don‚Äôt give the system any race information, but we do give the system an address and there is a current (or historic) correlation between race and loan declines‚Ä¶ the A.I. might secretly group together people based on where they live. There are examples of this, where certain poorer black neighbourhoods are being discriminated against/biased without the system knowing anything about these neighbourhoods or the race of the people living there.&lt;/p&gt;

&lt;h1 id=&quot;algorithms-are-bias&quot;&gt;Algorithms &lt;strong&gt;are&lt;/strong&gt; bias&lt;/h1&gt;

&lt;p&gt;The algorithmic bias problem isn‚Äôt going away, it will probably become much worse. Systems are getting more (and more) data and it will find many more correlations using this data.&lt;/p&gt;

&lt;p&gt;It is impossible to have algorithms without bias because these decision-making algorithms &lt;strong&gt;are&lt;/strong&gt; bias. The whole reason they exist is to add some bias into a neutral decision.&lt;/p&gt;

&lt;p&gt;What‚Äôs your thought on this? Send me a tweet: @&lt;a href=&quot;https://twitter.com/royvanrijn&quot;&gt;royvanrijn&lt;/a&gt;&lt;/p&gt;

</description>
        <pubDate>Tue, 12 Nov 2019 13:11:24 +0100</pubDate>
        <link>https://royvanrijn.com/blog/2019/11/the-world-of-biased-algorithms-copy/</link>
        <guid isPermaLink="true">https://royvanrijn.com/blog/2019/11/the-world-of-biased-algorithms-copy/</guid>
        
        <category>algorithm</category>
        
        <category>bias</category>
        
        
        <category>Algorithms</category>
        
      </item>
    
  </channel>
</rss>
