<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Java Generics for Compare</title>
  <meta name="description" content="I've been developing with Java 5+ for quite a while now. Not all developers are this lucky, some are still stuck with 1.4... some even with 1.3! But my clien...">
  <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
  
  <link rel="apple-touch-icon" href="/images/avatar.jpg" />

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://royvanrijn.com/blog/2009/12/java-generics-for-compare/">
  <link rel="alternate" type="application/rss+xml" title="royvanrijn" href="http://royvanrijn.com/feed/" />
  
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

	<a class="site-title" href="/">
	  <img src="/images/header_royvanrijn.jpg" alt="royvanrijn" />
    </a>

    <nav class="site-nav">

      <div class="trigger">
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    
    <div class="page-navigation"> 
      <div class="left"> 
         
          <a href="/blog/2009/12/son-of-darts/" title="Previous Post: Son Of Darts">&laquo; Son Of Darts</a> 
         
      </div> 
      <div class="right"> 
         
          <a href="/blog/2009/12/songsincode/" title="next Post: #songsincode">#songsincode &raquo; </a> 
         
      </div> 
      <div class="clear"></div> 
    </div> 

    <h1 class="post-title">Java Generics for Compare</h1>
    <p class="post-meta">
    	Dec 4, 2009 16:35:15
    	 - <a class="post-comments" href="http://royvanrijn.com/blog/2009/12/java-generics-for-compare/#disqus_thread"></a>
    </p>
  </header>

  <article class="post-content">
    <p>I've been developing with Java 5+ for quite a while now. Not all developers are this lucky, some are still stuck with 1.4... some even with 1.3! But my clients all made the excellent step forward to Java 5 (some even to 6). The problem is, they moved the runtime/JDK but forget to move their developers!</p>
<p>In Java 5 the language brings some good improvements, the for-loop is easy to understand, and almost all the developers are using this by now. The problem starts with generics. There is a part most developers understand, the Collections API. Almost all programmers use lists now as: List&lt;Integer&gt; instead of a plain old List. This is a good start, but it must not end here! First, I must admit, generics in Java can sometimes be hard and confusing (when using &lt;? extends X&gt; and &lt;? super X&gt;). So I'm not going to talk about any of this 'hard stuff'. Its the use of 'easy' generics that can our lifes so much easier.</p>
<p>For example the piece of code below:</p>
<p><!--more--></p>
<pre class="brush:java">
public class LabelPlaceholderComparator implements Comparator { 

    /**{@inheritDoc */
    public int compare(Object o1, Object o2) {
        LabelPlaceholder p1 = (LabelPlaceholder) o1;
        LabelPlaceholder p2 = (LabelPlaceholder) o2;
        return p1.getLabel().compareTo(p2.getLabel());
    }
}</pre>
<p>Of course, there seems to be not much wrong with the code, I see it all the time. Yes, the code breaks if you put something else in the comparator, but hey... the Javadoc says it only accepts LabelPlaceholders! So lets use this code:</p>
<pre class="brush:java">
List holders = fillList();
Collections.sort(holders, new LabelPlaceholderComparator());
</pre>
<p>Done! Its working and no problems right? Not quite, your IDE (Eclipse in my case) complains about this code.<br />
For example Eclipse says:</p>
<p><em>Type safety: The expression of type LabelPlaceholderComparator needs unchecked conversion to conform to Comparator&lt;? super T&gt;</em></p>
<p>At this point, most programmers at the company I work for now will just ignore this warning. They might even add:<br />
<em>@SuppressWarnings("unchecked")</em></p>
<p>What a shame... Lets just examine this warning, what is Eclipse trying to tell us here? The compiler doesn't know we created the Comparator with only LabelPlaceholders in mind. But the compiler does know (with generics) that the List only contains LabelPlaceholders. So the warning is (in understandable English):</p>
<p><em>I've got a list here of T (LabelPlaceholders) and a Comparator for Objects, this can go wrong! I'd rather have a specific Comparator for this job. Do you have one for me?</em></p>
<p>The solution to this problem is very simple, but most neglect to use it:</p>
<pre class="brush:java">public class LabelPlaceholderComparator implements Comparator&lt;LabelPlaceholder&gt; { 

    /**{@inheritDoc */
    public int compare(LabelPlaceholder p1, LabelPlaceholder p2) {
        return p1.getLabel().compareTo(p2.getLabel());
    }
}</pre>
<p>As you can see, the code is much smaller. The interface is now generified, it knows we are going to compare LabelPlaceholders now, nothing more, nothing less. Also, we don't have to cast anymore, because of the generics you can't put anything else in there.</p>
<p>So, lets go to the conclusion: Why is the latter code better code?</p>
<ol>
<li>As you can see, the code is smaller!</li>
<li>There are no casts, the code is safer (no ClassCastException or eleborate class checks)</li>
<li>If somebody uses your code, he/she knows what kind of objects the Comparator can handle. You don't have to read the Javadoc or the code to see what it does.</li>
</ol>
<p>Throughout the projects I encounter I keep finding examples of places where generics would have made the code smaller/safer/more understandable. For some reason the programmers still only use generics on collections. So, even though generics aren't perfect, please use them where/when you can, it'll always add clarity to the code, and most of the time it'll also make your code safer, and in some cases the code gets smaller because you can leave away casts and class-checks.</p>
<p>Don't ever let me see public int compare(Object o1, Object o2); again!</p>
<p>(You see, it is possible for me to have a discussion about Java generics without mentioning <a href="http://gafter.blogspot.com/2006/11/reified-generics-for-java.html">reified generics</a>!)</p>

  </article>

  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'royvanrijn';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-wrapper">
      
      <div class="footer-wrapper-content">
      
        <a href="https://www.linkedin.com/profile/view?id=10356027">
          <i class="svg-icon linkedin"></i>
        </a>
      
        <a href="http://stackoverflow.com/users/442274/roy-van-rijn">
          <i class="svg-icon stackoverflow"></i>
        </a>

        <a href="https://github.com/royvanrijn">
          <i class="svg-icon github"></i>
        </a>

        <a href="https://twitter.com/royvanrijn">
          <i class="svg-icon twitter"></i>
        </a>
          
        <a href="/feed/index.xml">
          <i class="svg-icon rss"></i>
        </a>
	  </div>
    
    </div>

  </div>
  
  <script>
  
  <!-- Google Analytics -->
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3219266-2', 'auto');
  ga('send', 'pageview');

  <!-- Disqus Comment Count -->
  var disqus_shortname = 'royvanrijn'; // required: replace example with your forum shortname
  (function () {
  var s = document.createElement('script'); s.async = true;
  s.type = 'text/javascript';
  s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());

  </script>

</footer>


  </body>

</html>
